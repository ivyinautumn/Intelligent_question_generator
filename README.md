# 本地知识库自动出题系统

一个基于大模型的智能出题系统，能够根据技术规范文档自动生成题目并提供答题功能。

## 功能特点

- 🤖 **智能出题**: 基于阿里百炼大模型，自动从技术规范中生成高质量题目
- 📚 **多种题型**: 支持单选题和判断题两种题型
- 📊 **实时反馈**: 答题过程中提供即时反馈和正确率统计
- 💾 **题库管理**: 自动保存生成的题库，支持重复使用
- 🎯 **灵活答题**: 支持从现有题库中随机选择题目进行练习

## 系统架构

```
Intelligent_assistant/
├── backend/           # 后端逻辑
│   ├── main.py       # 主要业务逻辑
│   └── ...
├── frontend/          # 前端界面
│   ├── app.py        # Streamlit应用
│   └── ...
├── raw_file/          # 原始JSON文件存储
├── question_dataset/  # 生成的题库存储
├── .env              # 环境变量配置
└── requirements.txt   # 依赖包列表
```

## 快速开始

### 1. 环境准备

```bash
# 克隆项目
git clone <repository-url>
cd Intelligent_assistant

# 安装依赖
pip install -r requirements.txt
```

### 2. 配置环境变量

创建 `.env` 文件并添加以下内容：

```
BAILIAN_API_KEY=your_api_key_here
BAILIAN_MODEL_NAME=qwen-turbo
```

### 3. 启动系统

```bash
# 使用启动脚本
# python run.py 暂时不使用

# 或者直接启动Streamlit
streamlit run frontend/app.py
```

### 4. 使用流程

1. **上传文档**: 在左侧上传符合格式的JSON技术规范文件
2. **生成题目**: 选择文档和题目数量，点击生成
3. **开始答题**: 系统自动进入答题模式
4. **查看结果**: 答题完成后查看正确率和学习建议

## 数据格式要求

### 输入JSON格式

```json
[
    {
        "idx": "4.4.1",
        "title": "计量功能",
        "text": "a） 具有正向、反向有功电能量计量功能。 b） 具有分时计量功能..."
    },
    {
        "idx": "4.4.2",
        "title": "时钟",
        "text": "a） 应具有日历、计时、闰年自动转换功能..."
    }
]
```

### 输出题库格式

```json
[
    {
        "idx": 1,
        "type": "single_choice",
        "question_": "题目内容",
        "option": "A. 选项A  B. 选项B  C. 选项C",
        "answer": "A",
        "source_file": "源文件名.json"
    },
    {
        "idx": 2,
        "type": "judge",
        "question_": "判断题内容",
        "answer": ["正确", "对", "是", "yes"],
        "source_file": "源文件名.json"
    }
]
```

## PDF转JSON工具

如果你有PDF格式的技术规范文件，可以使用提供的转换工具：

```bash
# 安装额外依赖
pip install PyMuPDF

# 运行转换工具
python pdf_to_json_converter.py
```

## 题目类型说明

### 单选题
- 基于文档内容生成问题和三个选项
- 用户可以输入选项字母（A/B/C）或完整选项内容
- 系统会自动判断答案正确性

### 判断题
- 基于文档内容生成判断陈述
- 用户可以输入多种正确答案格式（正确/错误/对/不对等）
- 系统支持多种答案格式的智能识别

## 注意事项

1. **API配置**: 确保阿里百炼API密钥正确配置
2. **文件格式**: 上传的JSON文件必须符合指定格式
3. **网络连接**: 生成题目需要网络连接调用大模型API
4. **资源占用**: 大批量生成题目可能需要较长时间

## 故障排除

### 常见问题

1. **API调用失败**
   - 检查API密钥是否正确
   - 确认网络连接正常
   - 检查API余额是否充足

2. **文件上传失败**
   - 确认文件格式为JSON
   - 检查JSON格式是否正确
   - 确认文件大小合理

3. **题目生成失败**
   - 检查源文件内容质量
   - 确认大模型响应正常
   - 尝试减少题目数量

### 日志调试

系统会在控制台输出详细的调试信息，包括：
- API调用状态
- 文件处理进度
- 题目生成过程
- 错误信息详情

## 技术支持

如遇到技术问题，请检查：
1. 环境变量配置
2. 依赖包安装
3. 文件格式规范
4. API服务状态

## 更新日志

### v1.0.0
- 初始版本发布
- 支持单选题和判断题生成
- 实现基本的答题功能
- 添加题库管理功能

## 许可证

本项目遵循 MIT 许可证。